<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Notas blancas y negras</title>
    <style>
      :root {
        --bg: #f5f5f5;
        --white: #ffffff;
        --black: #1f1f1f;
        --accent: #4aa3ff;
        --shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
        padding: 32px 16px 48px;
        background: var(--bg);
        font-family: "Arial", sans-serif;
      }

      .choices {
        display: grid;
        grid-template-columns: repeat(4, minmax(70px, 90px));
        gap: 16px 20px;
        margin-top: 8px;
      }

      .note-group {
        display: grid;
        gap: 8px;
        align-items: center;
        justify-items: center;
      }

      button {
        border: none;
        cursor: pointer;
        width: 80px;
        height: 60px;
        border-radius: 18px;
        box-shadow: var(--shadow);
        transition: transform 0.15s ease, box-shadow 0.15s ease;
      }

      button:focus-visible {
        outline: 3px solid var(--accent);
        outline-offset: 4px;
      }

      .white {
        background: var(--white);
      }

      .black {
        background: var(--black);
      }

      .selected {
        transform: translateY(-3px) scale(1.03);
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.15);
      }

      .animation {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        align-items: center;
        margin: 24px 0;
      }

      .pulse {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: #d9e6f7;
        box-shadow: inset 0 0 0 6px #c6d9f4;
        transition: transform 0.2s ease, background 0.2s ease;
      }

      .pulse.active {
        transform: scale(1.2);
        background: var(--accent);
      }

      .play {
        margin-top: 16px;
        width: 140px;
        height: 64px;
        border-radius: 26px;
        background: var(--accent);
        color: #ffffff;
        font-size: 18px;
        font-weight: 600;
        letter-spacing: 1px;
      }

      .play:active {
        transform: scale(0.98);
      }
    </style>
  </head>
  <body>
    <div class="choices" aria-label="Elegir notas blancas o negras">
      <div class="note-group" data-index="0">
        <button class="white selected" aria-label="Nota 1 blanca"></button>
        <button class="black" aria-label="Nota 1 negra"></button>
      </div>
      <div class="note-group" data-index="1">
        <button class="white selected" aria-label="Nota 2 blanca"></button>
        <button class="black" aria-label="Nota 2 negra"></button>
      </div>
      <div class="note-group" data-index="2">
        <button class="white selected" aria-label="Nota 3 blanca"></button>
        <button class="black" aria-label="Nota 3 negra"></button>
      </div>
      <div class="note-group" data-index="3">
        <button class="white selected" aria-label="Nota 4 blanca"></button>
        <button class="black" aria-label="Nota 4 negra"></button>
      </div>
    </div>

    <div class="animation" aria-hidden="true">
      <div class="pulse" data-pulse="0"></div>
      <div class="pulse" data-pulse="1"></div>
      <div class="pulse" data-pulse="2"></div>
      <div class="pulse" data-pulse="3"></div>
    </div>

    <button class="play" id="play" aria-label="Reproducir notas">â–¶</button>

    <script>
      const selections = ["white", "white", "white", "white"];
      const noteSets = [
        { white: 261.63, black: 277.18 },
        { white: 293.66, black: 311.13 },
        { white: 329.63, black: 349.23 },
        { white: 392.0, black: 415.3 },
      ];
      const groups = document.querySelectorAll(".note-group");
      const pulses = document.querySelectorAll(".pulse");
      const playButton = document.getElementById("play");

      groups.forEach((group) => {
        const index = Number(group.dataset.index);
        const buttons = group.querySelectorAll("button");
        buttons.forEach((button) => {
          button.addEventListener("click", () => {
            buttons.forEach((btn) => btn.classList.remove("selected"));
            button.classList.add("selected");
            selections[index] = button.classList.contains("white") ? "white" : "black";
          });
        });
      });

      function playSequence() {
        const context = new (window.AudioContext || window.webkitAudioContext)();
        const now = context.currentTime;
        const duration = 0.45;

        selections.forEach((choice, i) => {
          const oscillator = context.createOscillator();
          const gain = context.createGain();
          oscillator.type = "sine";
          oscillator.frequency.value = noteSets[i][choice];
          gain.gain.setValueAtTime(0.001, now + i * duration);
          gain.gain.exponentialRampToValueAtTime(0.2, now + i * duration + 0.05);
          gain.gain.exponentialRampToValueAtTime(0.001, now + i * duration + duration - 0.05);
          oscillator.connect(gain).connect(context.destination);
          oscillator.start(now + i * duration);
          oscillator.stop(now + i * duration + duration);

          setTimeout(() => {
            pulses[i].classList.add("active");
            setTimeout(() => pulses[i].classList.remove("active"), duration * 1000);
          }, i * duration * 1000);
        });
      }

      playButton.addEventListener("click", playSequence);
    </script>
  </body>
</html>
